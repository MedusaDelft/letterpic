!function(t){t.fn.letterpic=function(e){function n(t){var e=t.data().userid,n=t.attr("title");if(!n)return null;e||(e=n);var i=v[e];if(!i){f==d.colors.length&&(f=0);var o=d.colors[f++];i={text:r(n),color:o},v[e]=i}return i}function r(t){var e=t.split(" "),n=e[0].charAt(0).toUpperCase();return e.length>1&&(n+=e[1].charAt(0).toUpperCase()),n}function i(t){return t.complete?"undefined"!=typeof t.naturalWidth&&0===t.naturalWidth?!1:!0:!1}function o(e){a(t(e.target)),$img.off("error",o)}function a(e){var r;e.is("canvas")?r=e:(r=t("<canvas></canvas>"),t.each(e[0].attributes,function(t,e){r.attr(e.name,e.value)}),e.replaceWith(r));var i=n(r);l(r,i)}function l(t,e){var n=t[0],r=window.devicePixelRatio,i=r*t.width(),o=r*t.height(),a=n.getContext("2d");a.scale(r,r),t.attr("width",i),t.attr("height",o),a.fillStyle=e.color,a.fillRect(0,0,n.width,n.height);var l=i*d.fontSize;a.font=l+"px "+d.font,a.textAlign="center",a.fillStyle=d.fontColor,a.fillText(e.text,i/2,.45*(l+o)+2)}var f=0,c="Arial",u="#fff",h=.45,s=["#F44336","#673AB7","#03A9F4","#4CAF50","#FFEB3B","#FF5722","#607D8B","#E91E63","#3F51B5","#00BCD4","#8BC34A","#FFC107","#795548","#9C27B0","#2196F3","#009688","#CDDC39","#FF9800","#9E9E9E"],v={},d=t.extend({colors:s,font:c,fontColor:u,fontSize:h},e);this.each(function(){var e=t(this);e.is("img")&&i(e[0])?e.on("error",o):a(e)})}}(jQuery);